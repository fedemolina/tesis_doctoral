<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Desafíos que surgieron durante el trabajo de tesis | _main.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Desafíos que surgieron durante el trabajo de tesis | _main.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Desafíos que surgieron durante el trabajo de tesis | _main.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="4-cap-migsa.html"/>
<link rel="next" href="6-cap-conclusiones.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="1" data-path="1-cap-af.html"><a href="1-cap-af.html"><i class="fa fa-check"></i><b>1</b> Análisis funcional</a><ul>
<li class="chapter" data-level="1.1" data-path="1-cap-af.html"><a href="1-cap-af.html#sec:ontologias"><i class="fa fa-check"></i><b>1.1</b> Ontologías</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-cap-af.html"><a href="1-cap-af.html#gene-ontology"><i class="fa fa-check"></i><b>1.1.1</b> Gene Ontology</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-cap-af.html"><a href="1-cap-af.html#otras-ontologías"><i class="fa fa-check"></i><b>1.1.2</b> Otras ontologías</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-cap-af.html"><a href="1-cap-af.html#sec:af"><i class="fa fa-check"></i><b>1.2</b> Metodologías de Análisis Funcional (AF)</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-cap-af.html"><a href="1-cap-af.html#sec:asr"><i class="fa fa-check"></i><b>1.2.1</b> Análisis de Sobre-Representación (ASR)</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-cap-af.html"><a href="1-cap-af.html#puntuación-funcional-de-clase-pfc"><i class="fa fa-check"></i><b>1.2.2</b> Puntuación Funcional de Clase (PFC)</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-cap-af.html"><a href="1-cap-af.html#análisis-de-enriquecimiento-modular"><i class="fa fa-check"></i><b>1.2.3</b> Análisis de Enriquecimiento Modular</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-cap-af.html"><a href="1-cap-af.html#comentarios-finales"><i class="fa fa-check"></i><b>1.3</b> Comentarios finales</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html"><i class="fa fa-check"></i><b>2</b> Fuentes de datos biológicas</a><ul>
<li class="chapter" data-level="2.1" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#sec:technols"><i class="fa fa-check"></i><b>2.1</b> Tecnologías de obtención de expresión biológica</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#microarreglos-de-adn"><i class="fa fa-check"></i><b>2.1.1</b> Microarreglos de ADN</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#itraq"><i class="fa fa-check"></i><b>2.1.2</b> iTRAQ</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#secuenciación-de-arn"><i class="fa fa-check"></i><b>2.1.3</b> Secuenciación de ARN</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#sec:repos"><i class="fa fa-check"></i><b>2.2</b> Repositorios de datos de expresión</a></li>
<li class="chapter" data-level="2.3" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#condiciones-experimentales"><i class="fa fa-check"></i><b>2.3</b> Condiciones experimentales</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#sec:bcSubt"><i class="fa fa-check"></i><b>2.3.1</b> Cáncer de mama</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#cáncer-de-próstata"><i class="fa fa-check"></i><b>2.3.2</b> Cáncer de próstata</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-cap-ngs.html"><a href="2-cap-ngs.html#comentarios-finales-1"><i class="fa fa-check"></i><b>2.4</b> Comentarios finales</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html"><i class="fa fa-check"></i><b>3</b> Análisis Funcional Integrador</a><ul>
<li class="chapter" data-level="3.1" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#motivación"><i class="fa fa-check"></i><b>3.1</b> Motivación</a></li>
<li class="chapter" data-level="3.2" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#validación-de-resultados"><i class="fa fa-check"></i><b>3.2</b> Validación de resultados</a></li>
<li class="chapter" data-level="3.3" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#datos-de-entrada"><i class="fa fa-check"></i><b>3.3</b> Datos de entrada</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#matrices-de-expresión"><i class="fa fa-check"></i><b>3.3.1</b> Matrices de expresión</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#conjuntos-de-genes"><i class="fa fa-check"></i><b>3.3.2</b> Conjuntos de genes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#sec:algosComparados"><i class="fa fa-check"></i><b>3.4</b> Algoritmos y parámetros comparados</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#análisis-de-sobre-representación"><i class="fa fa-check"></i><b>3.4.1</b> Análisis de Sobre-Representación</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#puntuación-funcional-de-clase"><i class="fa fa-check"></i><b>3.4.2</b> Puntuación Funcional de Clase</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#resultados"><i class="fa fa-check"></i><b>3.5</b> Resultados</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#genes-diferencialmente-expresados-por-base-de-datos"><i class="fa fa-check"></i><b>3.5.1</b> Genes diferencialmente expresados por base de datos</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#análisis-de-estabilidad-de-enriquecimiento"><i class="fa fa-check"></i><b>3.5.2</b> Análisis de estabilidad de enriquecimiento</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#análisis-de-profundidad-en-gene-ontology"><i class="fa fa-check"></i><b>3.5.3</b> Análisis de profundidad en Gene Ontology</a></li>
<li class="chapter" data-level="3.5.4" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#sec:consensusSection"><i class="fa fa-check"></i><b>3.5.4</b> Análisis de consenso</a></li>
<li class="chapter" data-level="3.5.5" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#enriquecimiento-exclusivo-y-relevancia-de-términos"><i class="fa fa-check"></i><b>3.5.5</b> Enriquecimiento exclusivo y relevancia de términos</a></li>
<li class="chapter" data-level="3.5.6" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#sec:ifa"><i class="fa fa-check"></i><b>3.5.6</b> Análisis Funcional Integrador</a></li>
<li class="chapter" data-level="3.5.7" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#ifa-sobre-tcga"><i class="fa fa-check"></i><b>3.5.7</b> IFA sobre TCGA</a></li>
<li class="chapter" data-level="3.5.8" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#ifa-sobre-datasets-de-cáncer-de-próstata"><i class="fa fa-check"></i><b>3.5.8</b> IFA sobre datasets de cáncer de próstata</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#conclusiones"><i class="fa fa-check"></i><b>3.6</b> Conclusiones</a><ul>
<li class="chapter" data-level="3.6.1" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#comparación-de-métodos"><i class="fa fa-check"></i><b>3.6.1</b> Comparación de métodos</a></li>
<li class="chapter" data-level="3.6.2" data-path="3-cap-ifa.html"><a href="3-cap-ifa.html#aplicación-del-ifa"><i class="fa fa-check"></i><b>3.6.2</b> Aplicación del IFA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html"><i class="fa fa-check"></i><b>4</b> Análisis masivo e integrador de conjuntos de genes</a><ul>
<li class="chapter" data-level="4.1" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#motivación-1"><i class="fa fa-check"></i><b>4.1</b> Motivación</a></li>
<li class="chapter" data-level="4.2" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#sec:voom"><i class="fa fa-check"></i><b>4.2</b> Adaptación del IFA a otras fuentes de datos</a></li>
<li class="chapter" data-level="4.3" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#herramienta-desarrollada"><i class="fa fa-check"></i><b>4.3</b> Herramienta desarrollada</a></li>
<li class="chapter" data-level="4.4" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#validación-de-la-herramienta"><i class="fa fa-check"></i><b>4.4</b> Validación de la herramienta</a></li>
<li class="chapter" data-level="4.5" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#datos-de-entrada-1"><i class="fa fa-check"></i><b>4.5</b> Datos de entrada</a><ul>
<li class="chapter" data-level="4.5.1" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#matrices-de-expresión-1"><i class="fa fa-check"></i><b>4.5.1</b> Matrices de expresión</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#conjuntos-de-genes-1"><i class="fa fa-check"></i><b>4.5.2</b> Conjuntos de genes</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#estrategias-para-el-análisis-de-eficiencia"><i class="fa fa-check"></i><b>4.6</b> Estrategias para el análisis de eficiencia</a></li>
<li class="chapter" data-level="4.7" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#resultados-1"><i class="fa fa-check"></i><b>4.7</b> Resultados</a><ul>
<li class="chapter" data-level="4.7.1" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#migsa-sobre-datasets-de-microarreglos"><i class="fa fa-check"></i><b>4.7.1</b> MIGSA sobre datasets de microarreglos</a></li>
<li class="chapter" data-level="4.7.2" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#exploración-de-los-ptf-de-los-subtipos-de-cáncer-de-mama"><i class="fa fa-check"></i><b>4.7.2</b> Exploración de los PTF de los subtipos de cáncer de mama</a></li>
<li class="chapter" data-level="4.7.3" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#integración-de-resultados-de-migsa-de-tcga-y-haibe-kains"><i class="fa fa-check"></i><b>4.7.3</b> Integración de resultados de MIGSA de TCGA y Haibe-Kains</a></li>
<li class="chapter" data-level="4.7.4" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#exploración-de-los-resultados-de-tcga-en-conjunto-con-los-ptf"><i class="fa fa-check"></i><b>4.7.4</b> Exploración de los resultados de TCGA en conjunto con los PTF</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4-cap-migsa.html"><a href="4-cap-migsa.html#conclusiones-1"><i class="fa fa-check"></i><b>4.8</b> Conclusiones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-cap-desafios.html"><a href="5-cap-desafios.html"><i class="fa fa-check"></i><b>5</b> Desafíos que surgieron durante el trabajo de tesis</a><ul>
<li class="chapter" data-level="5.1" data-path="5-cap-desafios.html"><a href="5-cap-desafios.html#eficiencia-computacional-del-algoritmo-mgsz"><i class="fa fa-check"></i><b>5.1</b> Eficiencia computacional del algoritmo <code>mGSZ</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-cap-desafios.html"><a href="5-cap-desafios.html#optimización-del-algoritmo-mgsz"><i class="fa fa-check"></i><b>5.1.1</b> Optimización del algoritmo <code>mGSZ</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-cap-conclusiones.html"><a href="6-cap-conclusiones.html"><i class="fa fa-check"></i><b>6</b> Conclusiones y trabajo futuro</a></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cap:desafios" class="section level1">
<h1><span class="header-section-number">Capítulo 5</span> Desafíos que surgieron durante el trabajo de tesis</h1>
<div id="eficiencia-computacional-del-algoritmo-mgsz" class="section level2">
<h2><span class="header-section-number">5.1</span> Eficiencia computacional del algoritmo <code>mGSZ</code></h2>

<p>Como se vio en el Capítulo <a href="3-cap-ifa.html#cap:ifa">3</a>, el método <code>mGSZ</code> resultó ser la mejor alternativa para llevar a cabo el análisis funcional del tipo <em>Puntuación Funcional de Clase</em>. La función principal de <code>mGSZ</code>, con sus parámetros por defecto -que sugerimos como resultado del Capítulo <a href="3-cap-ifa.html#cap:ifa">3</a>-, realiza un máximo de 200 permutaciones y filtra solo aquellos conjuntos de genes que presentan menos de cinco genes. En este sentido, llevar a cabo el análisis funcional de <code>mGSZ</code> de un experimento ordinario, por ejemplo, Basal vs. Luminal A de datos de microarreglos del TCGA sobre Gene Ontology, en una computadora estándar, puede tomar alrededor de 2,46 horas, como mostramos a continuación.</p>

<p>Esta demora del algoritmo, puede resultar despreciable si se desea analizar un único experimento. Sin embargo, como objetivo global del presente trabajo de tesis, se propuso una herramienta de exploración, desde un punto de vista funcional, de grandes cantidades de experimentos. Si extrapolamos linealmente la demora del análisis funcional de un experimento a 118 experimentos (el número de experimentos analizados en el Capítulo <a href="4-cap-migsa.html#cap:migsa">4</a>), estaríamos hablando de una espera de 290,28 horas, es decir, 12,09 días. Dada esta situación, resultó fundamental afrontar este desafío, mediante la optimización del algoritmo original de <code>mGSZ</code>, de manera de disminuir el tiempo de ejecución.</p>
<div id="optimización-del-algoritmo-mgsz" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Optimización del algoritmo <code>mGSZ</code></h3>

<p>Para disminuir el tiempo de ejecución de <code>mGSZ</code>, en primer instancia se debió analizar el código del paquete <code>mGSZ</code> de manera de encontrar porciones de código críticas. Mediante los paquetes <code>profvis</code> y <code>microbenchmark</code> se detectaron tanto aquellas porciones de código de más lenta ejecución, como aquellas que más frecuentemente se ejecutaban. Como resultado de este análisis, se obtuvieron unos pocos fragmentos de código que fueron <strong>objetivos críticos</strong> a optimizar.</p>

<p>La optimización de estos objetivos críticos se llevo a cabo aplicando diversas estrategias de optimización generales <span class="citation">(<span class="citeproc-not-found" data-reference-id="wolfe1996high"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="cooper2011engineering"><strong>???</strong></span>)</span> como también algunas específicas del lenguaje R <span class="citation">(<span class="citeproc-not-found" data-reference-id="wickham2014advanced"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="gillespie2016efficient"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="burns2011r"><strong>???</strong></span>)</span>. Esta versión optimizada de la función <code>mGSZ</code> se implementó en el paquete <code>MIGSA</code>, y puede utilizarse, independientemente de <code>MIGSA</code>, llamando a la función <code>MIGSAmGSZ</code>.</p>

<p>Con el fin de evaluar las mejoras en tiempo de ejecución de <code>MIGSAmGSZ</code> con respecto a <code>mGSZ</code>, se analizaron ambas funciones dándoles como entrada los mismos input: la matriz de expresión de microarreglos de ADN de cáncer de mama del TCGA (16.207 genes <span class="math inline">\(\times\)</span> 237 sujetos), donde se contrastaron los subtipos Basal vs. Luminal A, analizando los conjuntos de genes del Gene Ontology y KEGG (20.425 conjuntos de genes). El análisis se llevó a cabo utilizando un procesador Intel(R) Xeon(R) E5-2620 v3 @ 2.40GHz (24 núcleos), y 128GB de memoria RAM.</p>

<p>Dicha comparación se puede replicar mediante el siguiente código:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;BiocParallel&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;mGSZ&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;MIGSA&quot;</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;MIGSAdata&quot;</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># Cargamos la matriz de expresión del TCGA</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">data</span>(tcgaMAdata)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">subtipos &lt;-<span class="st"> </span>tcgaMAdata<span class="op">$</span>subtypes</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">expresion &lt;-<span class="st"> </span>tcgaMAdata<span class="op">$</span>geneExpr</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">dim</span>(expresion) <span class="co"># #genes y #sujetos</span></a></code></pre></div>
<pre><code>[1] 16207   237</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">table</span>(subtipos) <span class="co"># #sujetos de cada subtipo</span></a></code></pre></div>
<pre><code>subtipos
Basal  LumA 
   95   142 </code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Cargamos los conjuntos de genes de KEGG y Gene Ontology</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># utilizando funciones de MIGSA</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">conj_genes &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">KEGG =</span> <span class="kw">downloadEnrichrGeneSets</span>(<span class="st">&quot;KEGG_2015&quot;</span>)[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">BP =</span> <span class="kw">loadGo</span>(<span class="st">&quot;BP&quot;</span>),</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">CC =</span> <span class="kw">loadGo</span>(<span class="st">&quot;CC&quot;</span>),</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">MF =</span> <span class="kw">loadGo</span>(<span class="st">&quot;MF&quot;</span>)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">conj_genes &lt;-<span class="st"> </span><span class="kw">do.call</span>(c, <span class="kw">lapply</span>(conj_genes, MIGSA<span class="op">:::</span>asList))</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Ejecutamos mGSZ original y medimos su tiempo de ejecución</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">8818</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">mGSZ_tiempo &lt;-<span class="st"> </span><span class="kw">system.time</span>({</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  mGSZ_res &lt;-<span class="st"> </span><span class="kw">mGSZ</span>(expresion, conj_genes, subtipos)<span class="op">$</span>mGSZ</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">})</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Ejecutamos MIGSAmGSZ y medimos su tiempo de ejecución</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">register</span>(<span class="kw">SerialParam</span>()) <span class="co"># linea que aclararemos a continuación</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">8818</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">MIGSAmGSZ_tiempo &lt;-<span class="st"> </span><span class="kw">system.time</span>({</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">  MIGSAmGSZ_res &lt;-<span class="st"> </span><span class="kw">MIGSAmGSZ</span>(expresion, conj_genes, subtipos)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">})</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Vemos el tiempo total (&quot;elapsed&quot;) y calculamos Speedup</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">mGSZ_tiempo &lt;-<span class="st"> </span>mGSZ_tiempo[[<span class="st">&quot;elapsed&quot;</span>]]</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">MIGSAmGSZ_tiempo &lt;-<span class="st"> </span>MIGSAmGSZ_tiempo[[<span class="st">&quot;elapsed&quot;</span>]]</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  <span class="dt">mGSZ =</span> mGSZ_tiempo <span class="op">/</span><span class="st"> </span><span class="dv">60</span> <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,            <span class="co"># en horas</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">  <span class="dt">MIGSAmGSZ =</span> MIGSAmGSZ_tiempo <span class="op">/</span><span class="st"> </span><span class="dv">60</span> <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,  <span class="co"># en horas</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  <span class="dt">Speedup =</span> mGSZ_tiempo <span class="op">/</span><span class="st"> </span>MIGSAmGSZ_tiempo</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">)</a></code></pre></div>
<pre><code>     mGSZ MIGSAmGSZ   Speedup 
 2.461000  1.553534  1.584130 </code></pre>
<p>Como se observa, la versión optimizada, <code>MIGSAmGSZ</code>, presenta un <em>speedup</em> de 1,6X sobre el algoritmo original -de demorar 2,46 horas, la nueva versión pasó a demorar 1,55 horas-.</p>

<p>Por otra parte, la implementación original de <code>mGSZ</code> se ejecuta, exclusivamente, de modo secuencial. En la actualidad, siendo tan fácil el acceso a computadores multi-procesador, el algoritmo <code>mGSZ</code> deja de lado una alternativa muy favorable en cuanto a la eficiencia en el tiempo de ejecución.</p>

<p>Como segunda fase de la reimplementación de <code>mGSZ</code>, detectamos cuáles porciones de código de <code>MIGSAmGSZ</code> podrían ejecutarse en paralelo y otorgarían un <em>speedup</em> considerable. Utilizando el paquete <code>BiocParallel</code>, se paralelizaron aquellas rutinas que consideramos pertinentes, y se brindó una sencilla interfaz de paralelismo al usuario. El análisis de la ganancia obtenida, gracias al paralelismo de <code>MIGSAmGSZ</code>, se puede replicar mediante el siguiente código:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Evaluamos MIGSAmGSZ con 1, 2, 4, 8, 10, 12 y 14 núcleos</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">nucleos &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">resultados &lt;-<span class="st"> </span><span class="kw">lapply</span>(nucleos, <span class="cf">function</span>(act_nucl) {</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  <span class="co"># Mediante las siguientes 4 líneas de código se le indica</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  <span class="co"># la cantidad de núcleos en las que debe ejecutarse MIGSAmGSZ.</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  <span class="co"># El parámetro &#39;workers&#39; indica la cantidad de núcleos a utilizar.</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="kw">register</span>(<span class="kw">MulticoreParam</span>(</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    <span class="dt">workers =</span> act_nucl, <span class="dt">threshold =</span> <span class="st">&quot;DEBUG&quot;</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">    <span class="dt">progressbar =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  ))</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12">  <span class="kw">set.seed</span>(<span class="dv">8818</span>)</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">  MIGSAmGSZ_tiempo &lt;-<span class="st"> </span><span class="kw">system.time</span>({</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">    MIGSAmGSZ_res &lt;-<span class="st"> </span><span class="kw">MIGSAmGSZ</span>(expresion, conj_genes, subtipos)</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">  })</a>
<a class="sourceLine" id="cb16-16" data-line-number="16"></a>
<a class="sourceLine" id="cb16-17" data-line-number="17">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">tiempo =</span> MIGSAmGSZ_tiempo, <span class="dt">res =</span> MIGSAmGSZ_res))</a>
<a class="sourceLine" id="cb16-18" data-line-number="18">})</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Para cada ejecución conservamos el tiempo total (&quot;elapsed&quot;) </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># y calculamos Speedup y Eficiencia sobre mGSZ</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">tiempos_segs &lt;-<span class="st"> </span><span class="kw">sapply</span>(resultados, <span class="cf">function</span>(act_res) {</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  act_res<span class="op">$</span>tiempo[[<span class="st">&quot;elapsed&quot;</span>]]</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw">names</span>(tiempos_segs) &lt;-<span class="st"> </span>nucleos</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">metricas &lt;-<span class="st"> </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">  <span class="st">&quot;Demora (mins)&quot;</span> =<span class="st"> </span>tiempos_segs <span class="op">/</span><span class="st"> </span><span class="dv">60</span>, <span class="co"># en minutos</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">  <span class="dt">Speedup =</span> mGSZ_tiempo <span class="op">/</span><span class="st"> </span>tiempos_segs,</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">  <span class="dt">Eficiencia =</span> (mGSZ_tiempo <span class="op">/</span><span class="st"> </span>tiempos_segs) <span class="op">/</span><span class="st"> </span>nucleos</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="kw">round</span>(metricas, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>                  1     2     4     8    10    12    14
Demora (mins) 93.21 46.50 24.98 15.63 13.67 14.79 28.43
Speedup        1.58  3.18  5.91  9.45 10.81  9.98  5.19
Eficiencia     1.58  1.59  1.48  1.18  1.08  0.83  0.37</code></pre>

<p>Como puede observarse en la tabla superior, sin importar el número de núcleos en los que se haya corrido <code>MIGSAmGSZ</code>, su rendimiento fue superior al de <code>mGSZ</code>. Ejecutándose en un núcleo muestra un <em>speedup</em> de 1,6X, alcanzando un máximo de 10,8X con diez núcleos. Gracias a la optimización desarrollada, es posible obtener en 14 minutos los mismos resultados que se obtenían en 2,46 horas de ejecución con el <code>mGSZ</code> original. Extrapolando a 118 experimentos, pasaríamos de una demora de 12,09 días, a tan solo 27,53 horas.</p>

<p>Como se mencionó previamente, la función optimizada y paralelizada <code>MIGSAmGSZ</code> se encuentra incluída en el paquete <code>MIGSA</code>, y se utiliza siguiendo los mismos parámtros que la versión original <code>mGSZ</code>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-cap-migsa.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="6-cap-conclusiones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["RodriguezJC_tesis_doctoral.pdf", "PDF"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
